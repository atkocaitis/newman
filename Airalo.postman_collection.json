{
	"info": {
		"_postman_id": "0c5ff36c-7973-412b-bb47-855aa9c11cb8",
		"name": "Airalo",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "758198"
	},
	"item": [
		{
			"name": "Get auth token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"// JSON Schema Validation",
							"const schema = {",
							"  \"type\": \"object\",",
							"  \"properties\": {",
							"    \"data\": {",
							"      \"type\": \"object\",",
							"      \"properties\": {",
							"        \"token_type\": {",
							"          \"type\": \"string\"",
							"        },",
							"        \"expires_in\": {",
							"          \"type\": \"integer\"",
							"        },",
							"        \"access_token\": {",
							"          \"type\": \"string\"",
							"        }",
							"      },",
							"      \"required\": [\"token_type\", \"expires_in\", \"access_token\"]",
							"    },",
							"    \"meta\": {",
							"      \"type\": \"object\",",
							"      \"properties\": {",
							"        \"message\": {",
							"          \"type\": \"string\"",
							"        }",
							"      },",
							"      \"required\": [\"message\"]",
							"    }",
							"  },",
							"  \"required\": [\"data\", \"meta\"]",
							"};",
							"",
							"// Validate the JSON response against the schema",
							"pm.test(\"JSON schema is valid\", function () {",
							"    pm.response.to.have.jsonSchema(schema);",
							"});",
							"",
							"var jsonData = pm.response.json();",
							"",
							"pm.environment.set(\"access_token\", jsonData.data.access_token);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "client_id",
							"value": "{{client_id}}",
							"type": "text"
						},
						{
							"key": "client_secret",
							"value": "{{client_secret}}",
							"type": "text"
						},
						{
							"key": "grant_type",
							"value": "client_credentials",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "https://sandbox-partners-api.airalo.com/v2/token",
					"protocol": "https",
					"host": [
						"sandbox-partners-api",
						"airalo",
						"com"
					],
					"path": [
						"v2",
						"token"
					]
				}
			},
			"response": []
		},
		{
			"name": "Submit Order",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"// Status Code Verification",
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"// JSON Schema Validation",
							"const schema = {",
							"  \"type\": \"object\",",
							"  \"properties\": {",
							"    \"data\": {",
							"      \"type\": \"object\",",
							"      \"properties\": {",
							"        \"id\": {",
							"          \"type\": \"integer\"",
							"        },",
							"        \"code\": {",
							"          \"type\": \"string\"",
							"        },",
							"        \"currency\": {",
							"          \"type\": \"string\"",
							"        },",
							"        \"package_id\": {",
							"          \"type\": \"string\"",
							"        },",
							"        \"quantity\": {",
							"          \"type\": \"integer\"",
							"        },",
							"        \"type\": {",
							"          \"type\": \"string\"",
							"        },",
							"        \"description\": {",
							"          \"type\": [\"string\", \"null\"]",
							"        },",
							"        \"esim_type\": {",
							"          \"type\": \"string\"",
							"        },",
							"        \"validity\": {",
							"          \"type\": \"integer\"",
							"        },",
							"        \"package\": {",
							"          \"type\": \"string\"",
							"        },",
							"        \"data\": {",
							"          \"type\": \"string\"",
							"        },",
							"        \"price\": {",
							"          \"type\": \"number\"",
							"        },",
							"        \"created_at\": {",
							"          \"type\": \"string\"",
							"        },",
							"        \"manual_installation\": {",
							"          \"type\": \"string\"",
							"        },",
							"        \"qrcode_installation\": {",
							"          \"type\": \"string\"",
							"        },",
							"        \"installation_guides\": {",
							"          \"type\": \"object\",",
							"          \"properties\": {",
							"            \"en\": {",
							"              \"type\": \"string\"",
							"            }",
							"          }",
							"        },",
							"        \"text\": {",
							"          \"type\": [\"string\", \"null\"]",
							"        },",
							"        \"voice\": {",
							"          \"type\": [\"string\", \"null\"]",
							"        },",
							"        \"net_price\": {",
							"          \"type\": \"number\"",
							"        },",
							"        \"brand_settings_name\": {",
							"          \"type\": [\"string\", \"null\"]",
							"        },",
							"        \"sims\": {",
							"          \"type\": \"array\",",
							"          \"items\": {",
							"            \"type\": \"object\",",
							"            \"properties\": {",
							"              \"id\": {",
							"                \"type\": \"integer\"",
							"              },",
							"              \"created_at\": {",
							"                \"type\": \"string\"",
							"              },",
							"              \"iccid\": {",
							"                \"type\": \"string\"",
							"              },",
							"              \"lpa\": {",
							"                \"type\": \"string\"",
							"              },",
							"              \"imsis\": {",
							"                \"type\": [\"string\", \"null\"]",
							"              },",
							"              \"matching_id\": {",
							"                \"type\": \"string\"",
							"              },",
							"              \"qrcode\": {",
							"                \"type\": \"string\"",
							"              },",
							"              \"qrcode_url\": {",
							"                \"type\": \"string\"",
							"              },",
							"              \"airalo_code\": {",
							"                \"type\": [\"string\", \"null\"]",
							"              },",
							"              \"apn_type\": {",
							"                \"type\": \"string\"",
							"              },",
							"              \"apn_value\": {",
							"                \"type\": \"string\"",
							"              },",
							"              \"is_roaming\": {",
							"                \"type\": \"boolean\"",
							"              },",
							"              \"confirmation_code\": {",
							"                \"type\": [\"string\", \"null\"]",
							"              },",
							"              \"apn\": {",
							"                \"type\": \"object\",",
							"                \"properties\": {",
							"                  \"ios\": {",
							"                    \"type\": \"object\",",
							"                    \"properties\": {",
							"                      \"apn_type\": {",
							"                        \"type\": \"string\"",
							"                      },",
							"                      \"apn_value\": {",
							"                        \"type\": \"string\"",
							"                      }",
							"                    },",
							"                    \"required\": [\"apn_type\", \"apn_value\"]",
							"                  },",
							"                  \"android\": {",
							"                    \"type\": \"object\",",
							"                    \"properties\": {",
							"                      \"apn_type\": {",
							"                        \"type\": \"string\"",
							"                      },",
							"                      \"apn_value\": {",
							"                        \"type\": \"string\"",
							"                      }",
							"                    },",
							"                    \"required\": [\"apn_type\", \"apn_value\"]",
							"                  }",
							"                },",
							"                \"required\": [\"ios\", \"android\"]",
							"              },",
							"              \"msisdn\": {",
							"                \"type\": [\"string\", \"null\"]",
							"              },",
							"              \"direct_apple_installation_url\": {",
							"                \"type\": \"string\"",
							"              }",
							"            },",
							"            \"required\": [",
							"              \"id\",",
							"              \"created_at\",",
							"              \"iccid\",",
							"              \"lpa\",",
							"              \"matching_id\",",
							"              \"qrcode\",",
							"              \"qrcode_url\",",
							"              \"apn_type\",",
							"              \"apn_value\",",
							"              \"is_roaming\",",
							"              \"apn\",",
							"              \"direct_apple_installation_url\"",
							"            ]",
							"          }",
							"        }",
							"      },",
							"      \"required\": [",
							"        \"id\",",
							"        \"code\",",
							"        \"currency\",",
							"        \"package_id\",",
							"        \"quantity\",",
							"        \"type\",",
							"        \"esim_type\",",
							"        \"validity\",",
							"        \"package\",",
							"        \"data\",",
							"        \"price\",",
							"        \"created_at\",",
							"        \"manual_installation\",",
							"        \"qrcode_installation\",",
							"        \"installation_guides\",",
							"        \"net_price\",",
							"        \"sims\"",
							"      ]",
							"    },",
							"    \"meta\": {",
							"      \"type\": \"object\",",
							"      \"properties\": {",
							"        \"message\": {",
							"          \"type\": \"string\"",
							"        }",
							"      },",
							"      \"required\": [\"message\"]",
							"    }",
							"  },",
							"  \"required\": [\"data\", \"meta\"]",
							"};",
							"",
							"// Validate the JSON response against the schema",
							"pm.test(\"JSON schema is valid\", function () {",
							"    pm.response.to.have.jsonSchema(schema);",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"const timestamp = new Date().toISOString();",
							"",
							"pm.environment.set(\"currentTimestamp\", timestamp);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{access_token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "quantity",
							"value": "6",
							"type": "text"
						},
						{
							"key": "package_id",
							"value": "merhaba-7days-1gb",
							"type": "text"
						},
						{
							"key": "description",
							"value": "{{currentTimestamp}}",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "https://sandbox-partners-api.airalo.com/v2/orders",
					"protocol": "https",
					"host": [
						"sandbox-partners-api",
						"airalo",
						"com"
					],
					"path": [
						"v2",
						"orders"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get eSIMs List",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"// Status Code Verification",
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"// JSON Schema Validation",
							"const schema = {",
							"        type: \"object\",",
							"        properties: {",
							"            data: {",
							"                type: \"array\",",
							"                items: {",
							"                    type: \"object\",",
							"                    properties: {",
							"                        id: { type: \"integer\" },",
							"                        created_at: { type: \"string\" },",
							"                        iccid: { type: \"string\" },",
							"                        lpa: { type: \"string\" },",
							"                        imsis: { type: [\"string\", \"null\"] },",
							"                        matching_id: { type: \"string\" },",
							"                        confirmation_code: { type: [\"string\", \"null\"] },",
							"                        qrcode: { type: \"string\" },",
							"                        qrcode_url: { type: \"string\" },",
							"                        direct_apple_installation_url: { type: \"string\" },",
							"                        voucher_code: { type: [\"string\", \"null\"] },",
							"                        airalo_code: { type: [\"string\", \"null\"] },",
							"                        apn_type: { type: \"string\" },",
							"                        apn_value: { type: \"string\" },",
							"                        is_roaming: { type: \"boolean\" },",
							"                        brand_settings_name: { type: [\"string\", \"null\"] },",
							"                        msisdn: { type: [\"string\", \"null\"] },",
							"                        apn: {",
							"                            type: \"object\",",
							"                            properties: {",
							"                                ios: {",
							"                                    type: \"object\",",
							"                                    properties: {",
							"                                        apn_type: { type: \"string\" },",
							"                                        apn_value: { type: \"string\" }",
							"                                    },",
							"                                    required: [\"apn_type\", \"apn_value\"]",
							"                                },",
							"                                android: {",
							"                                    type: \"object\",",
							"                                    properties: {",
							"                                        apn_type: { type: \"string\" },",
							"                                        apn_value: { type: \"string\" }",
							"                                    },",
							"                                    required: [\"apn_type\", \"apn_value\"]",
							"                                }",
							"                            },",
							"                            required: [\"ios\", \"android\"]",
							"                        },",
							"                        simable: {",
							"                            type: \"object\",",
							"                            properties: {",
							"                                id: { type: \"integer\" },",
							"                                code: { type: \"string\" },",
							"                                package_id: { type: \"string\" },",
							"                                currency: { type: \"string\" },",
							"                                quantity: { type: \"integer\" },",
							"                                type: { type: \"string\" },",
							"                                description: { type: [\"string\", \"null\"] },",
							"                                esim_type: { type: \"string\" },",
							"                                validity: { type: \"string\" },",
							"                                package: { type: \"string\" },",
							"                                data: { type: \"string\" },",
							"                                price: { type: \"string\" },",
							"                                created_at: { type: \"string\" },",
							"                                manual_installation: { type: \"string\" },",
							"                                qrcode_installation: { type: \"string\" },",
							"                                installation_guides: {",
							"                                    type: \"object\",",
							"                                    properties: {",
							"                                        en: { type: \"string\" }",
							"                                    }",
							"                                },",
							"                                text: { type: [\"string\", \"null\"] },",
							"                                voice: { type: [\"string\", \"null\"] },",
							"                                net_price: { type: \"number\" }",
							"                            },",
							"                            required: [",
							"                                \"id\", \"code\", \"package_id\", \"currency\", \"quantity\", ",
							"                                \"type\", \"description\", \"esim_type\", \"validity\", ",
							"                                \"package\", \"data\", \"price\", \"created_at\", ",
							"                                \"manual_installation\", \"qrcode_installation\", ",
							"                                \"installation_guides\", \"net_price\"",
							"                            ]",
							"                        }",
							"                    },",
							"                    required: [",
							"                        \"id\", \"created_at\", \"iccid\", \"lpa\", \"matching_id\", ",
							"                        \"qrcode\", \"qrcode_url\", \"direct_apple_installation_url\", ",
							"                        \"apn_type\", \"apn_value\", \"is_roaming\", \"apn\", \"simable\"",
							"                    ]",
							"                }",
							"            },",
							"            links: {",
							"                type: \"object\",",
							"                properties: {",
							"                    first: { type: \"string\" },",
							"                    last: { type: \"string\" },",
							"                    prev: { type: [\"string\", \"null\"] },",
							"                    next: { type: \"string\" }",
							"                },",
							"                required: [\"first\", \"last\", \"next\"]",
							"            },",
							"            meta: {",
							"                type: \"object\",",
							"                properties: {",
							"                    message: { type: \"string\" },",
							"                    current_page: { type: \"integer\" },",
							"                    from: { type: \"integer\" },",
							"                    last_page: { type: \"integer\" },",
							"                    path: { type: \"string\" },",
							"                    per_page: { type: \"string\" },",
							"                    to: { type: \"integer\" },",
							"                    total: { type: \"integer\" }",
							"                },",
							"                required: [",
							"                    \"message\", \"current_page\", \"from\", ",
							"                    \"last_page\", \"path\", \"per_page\", \"to\", \"total\"",
							"                ]",
							"            }",
							"        },",
							"        required: [\"data\", \"links\", \"meta\"]",
							"    };",
							"",
							"// Validate the JSON response against the schema",
							"pm.test(\"JSON schema is valid\", function () {",
							"    pm.response.to.have.jsonSchema(schema);",
							"});",
							"",
							"const responseJson = pm.response.json();",
							"const packageIdCount = responseJson.data.filter(item => item.simable.description === pm.environment.get(\"currentTimestamp\")).length;",
							"pm.test(\"There are exactly 6 elements from order request\", function () {",
							"    pm.expect(packageIdCount).to.equal(6);",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{access_token}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "https://sandbox-partners-api.airalo.com/v2/sims?include=order",
					"protocol": "https",
					"host": [
						"sandbox-partners-api",
						"airalo",
						"com"
					],
					"path": [
						"v2",
						"sims"
					],
					"query": [
						{
							"key": "include",
							"value": "order"
						}
					]
				}
			},
			"response": []
		}
	]
}